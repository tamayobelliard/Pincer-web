<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pincer - Ordena desde tu mesa</title>
  <style>
    /* ===== TU CSS ORIGINAL (NO TOCADO) ===== */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;padding-bottom:100px}
    .container{max-width:500px;margin:0 auto}
    .header{text-align:center;color:white;margin-bottom:30px}
    .header h1{font-size:2.5em;margin-bottom:10px}
    .menu-section,.order-summary{background:white;border-radius:16px;padding:20px;margin-bottom:20px}
    .menu-item{background:#f8fafc;border-radius:12px;padding:15px;margin-bottom:12px;display:flex;justify-content:space-between}
    .add-btn{background:#3b82f6;color:white;border:none;padding:10px 18px;border-radius:8px}
    .order-item{display:flex;justify-content:space-between;padding:10px;background:#f1f5f9;border-radius:8px;margin-bottom:8px}
    .remove-btn{background:#ef4444;color:white;border:none;padding:5px 10px;border-radius:6px}
    .place-order-btn{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);width:calc(100% - 40px);max-width:460px;background:#16a34a;color:white;border:none;padding:16px;border-radius:12px;font-size:1.2em}
    .status-box{margin-top:15px;padding:15px;border-radius:10px;text-align:center;font-weight:bold;font-size:1.1em}
    .pending{background:#fde68a;color:#92400e}
    .preparing{background:#bfdbfe;color:#1e40af}
    .ready{background:#bbf7d0;color:#065f46}
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>üçî Pincer</h1>
    <p>Ordena desde tu mesa</p>
  </div>

  <div class="menu-section">
    <h2>Men√∫</h2>
    <button class="add-btn" onclick="addItem('Hamburguesa',10)">üçî Hamburguesa $10</button><br><br>
    <button class="add-btn" onclick="addItem('Pizza',12)">üçï Pizza $12</button><br><br>
    <button class="add-btn" onclick="addItem('Papas',4)">üçü Papas $4</button>
  </div>

  <div class="order-summary">
    <h2>Tu pedido</h2>
    <div id="orderList"></div>
    <div id="orderStatus"></div>
  </div>
</div>

<button class="place-order-btn" onclick="placeOrder()">Enviar Pedido</button>

<!-- üîä Sonido -->
<audio id="statusSound">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
</audio>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://wtkqpfswpkfgztozgwzl.supabase.co";
  const SUPABASE_KEY = "TU_ANON_KEY";
  const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  let order = [];
  let currentOrderId = null;
  let lastStatus = null;

  function addItem(name, price) {
    order.push({ name, price });
    renderOrder();
  }

  function renderOrder() {
    const list = document.getElementById("orderList");
    list.innerHTML = "";
    order.forEach(i => {
      list.innerHTML += `<div class="order-item">${i.name} - $${i.price}</div>`;
    });
  }

  async function placeOrder() {
    if (order.length === 0) return alert("Pedido vac√≠o");

    const items = order.map(i => i.name).join(", ");
    const total = order.reduce((s,i)=>s+i.price,0);

    const { data, error } = await db
      .from("orders")
      .insert({
        items,
        total,
        status: "pending"
      })
      .select()
      .single();

    if (error) return alert("Error");

    currentOrderId = data.id;
    order = [];
    renderOrder();
    startStatusCheck();
    showStatus("Pedido enviado", "pending");
  }

  function showStatus(text, statusClass) {
    const box = document.getElementById("orderStatus");
    box.className = `status-box ${statusClass}`;
    box.innerText = text;
  }

  function startStatusCheck() {
    setInterval(checkStatus, 5000);
  }

  async function checkStatus() {
    if (!currentOrderId) return;

    const { data } = await db
      .from("orders")
      .select("status")
      .eq("id", currentOrderId)
      .single();

    if (!data || data.status === lastStatus) return;

    lastStatus = data.status;
    document.getElementById("statusSound").play();

    if (data.status === "preparing") {
      showStatus("üü° En preparaci√≥n", "preparing");
    }

    if (data.status === "ready") {
      showStatus("üü¢ Lista para retirar", "ready");
    }
  }
</script>
</body>
</html>







